LDI R1, LEVEL; pointer to level
LDI R2, 0; level X / draw limit

DRWBGDLOOP:
CMPI R2, 100
JEQI GAMESTART
LD R3, R1
DRWB R2, R3
INC R1
INC R2
JMPI DRWBGDLOOP

; DRWSCRN:
; DRW R3, R4
; IRET

GAMESTART:
LDI R3, 50 ; player x
LDI R4, 10 ; player y
; SET
; LDI R0, 0XF8
; LDI R1, DRWSCRN
; ST R0, R1
; LDI R5, 1

GAMELOOP:
INC R4 ; gravity
LDI R1, 0xF4
LD R2, R1
LDI R1, 65 ; a key
CMP R2, R1
CALLI MOVELEFT
LDI R1, 68 ; d key
CMP R2, R1
CALLI MOVERIGHT
LDI R1, 87 ; w key
CMP R2, R1
CALLI MOVEUP
LDI R1, 83 ; s key
CMP R2, R1
CALLI MOVEDOWN
LDI R1, LEVEL
ADD R1, R3
LD R2, R1
CMP R4, R2 ; test player against the level
CALLI HITFLOOR
DRW R3, R4
JMPI GAMELOOP


MOVEUP:
JEQI Y
RET
Y:
SUBI R4, 3
; CALLI CLEARKEY
RET

MOVEDOWN:
JEQI R
RET
R:
INC R4
; CALLI CLEARKEY
RET

MOVELEFT:
JEQI D
RET
D:
DEC R3
; CALLI CLEARKEY
RET

MOVERIGHT:
JEQI Z
RET
Z:
INC R3
; CALLI CLEARKEY
RET

; CLEARKEY:
; LDI R1, 0
; LDI R2, 0xF4
; ST R2, R1
; RET

HITFLOOR:
JGEI K
RET
K:
DEC R2
CPY R4, R2
RET

LEVEL:
DB 23
DB 23
DB 23
DB 24
DB 25
DB 25
DB 25
DB 25
DB 25
DB 24
DB 24
DB 24
DB 25
DB 25
DB 25
DB 24
DB 25
DB 26
DB 27
DB 27
DB 26
DB 25
DB 24
DB 25
DB 25
DB 25
DB 25
DB 24
DB 23
DB 23
DB 23
DB 24
DB 25
DB 25
DB 25
DB 25
DB 25
DB 24
DB 24
DB 24
DB 25
DB 25
DB 25
DB 24
DB 25
DB 26
DB 27
DB 27
DB 26
DB 25
DB 24
DB 25
DB 25
DB 25
DB 25
DB 23
DB 23
DB 23
DB 24
DB 25
DB 25
DB 25
DB 25
DB 25
DB 24
DB 24
DB 24
DB 25
DB 25
DB 25
DB 24
DB 25
DB 26
DB 27
DB 27
DB 26
DB 25
DB 24
DB 25
DB 25
DB 25
DB 25
DB 24
DB 23
DB 23
DB 23
DB 24
DB 25
DB 25
DB 25
DB 25
DB 25
DB 24
DB 24
DB 24
DB 24
DB 24
DB 24
DB 24
DB 24